#!/bin/bash

# Script untuk menampilkan CORRECT redirect URIs untuk Google Cloud Console
# Jalankan: bash scripts/correct-google-oauth-uris.sh

echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo "   âœ… REDIRECT URIs YANG BENAR untuk Google Cloud Console"
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "âš ï¸  PERHATIAN:"
echo "   Google Cloud Console HANYA menerima HTTP/HTTPS URIs"
echo "   Custom schemes (exp://, parentingai://) TIDAK BISA digunakan"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸ”— LANGKAH 1: Buka Google Cloud Console"
echo "   https://console.cloud.google.com/apis/credentials"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸ“ LANGKAH 2: Pilih Web Client ID (bukan Android/iOS)"
echo "   Pastikan Anda edit 'Web application' OAuth client"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "âœ… LANGKAH 3: Tambahkan HANYA URI ini:"
echo ""
echo "   https://gbcxzkgzhylpbmzbymwj.supabase.co/auth/v1/callback"
echo ""
echo "   (COPY PASTE URI di atas - ini satu-satunya yang perlu ditambahkan)"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "âŒ JANGAN tambahkan URI berikut (akan ditolak Google):"
echo "   â€¢ exp://192.168.1.4:8081       âŒ Custom scheme tidak diterima"
echo "   â€¢ parentingai://               âŒ Custom scheme tidak diterima"
echo "   â€¢ parentingai://auth-callback  âŒ Custom scheme tidak diterima"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸ”‘ LANGKAH 4: Setup di Supabase Dashboard"
echo "   https://supabase.com/dashboard/project/gbcxzkgzhylpbmzbymwj/auth/providers"
echo ""
echo "   1. Enable 'Google' provider"
echo "   2. Masukkan Web Client ID dari Google Console"
echo "   3. Masukkan Web Client Secret dari Google Console"
echo "   4. SAVE"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸ“± LANGKAH 5: Configure Redirect URLs di Supabase"
echo "   https://supabase.com/dashboard/project/gbcxzkgzhylpbmzbymwj/auth/url-configuration"
echo ""
echo "   Site URL:"
echo "   parentingai://auth-callback"
echo ""
echo "   Redirect URLs (tambahkan satu per satu):"
echo "   parentingai://auth-callback"
echo "   exp://192.168.1.4:8081"
echo "   http://localhost:8081"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸ‘¥ LANGKAH 6: Tambahkan Test User"
echo "   https://console.cloud.google.com/apis/credentials/consent"
echo ""
echo "   1. Scroll ke 'Test users'"
echo "   2. Klik '+ ADD USERS'"
echo "   3. Masukkan: artconcept91@gmail.com"
echo "   4. SAVE"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸ”„ LANGKAH 7: Restart Expo"
echo ""
echo "   npx expo start --clear"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸ“š PENJELASAN:"
echo ""
echo "   Google OAuth Flow untuk Native Apps:"
echo "   1. App opens browser â†’ Google login page"
echo "   2. User signs in â†’ Google redirects to Supabase callback"
echo "   3. Supabase validates â†’ Redirects back to app (parentingai://)"
echo "   4. App receives session â†’ User logged in âœ…"
echo ""
echo "   Jadi Google hanya perlu tahu tentang Supabase URL,"
echo "   BUKAN tentang custom app scheme!"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "â° TUNGGU 2-3 MENIT setelah save"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
echo "ğŸ’¡ RINGKASAN:"
echo "   â€¢ Google Console: Hanya Supabase callback URL"
echo "   â€¢ Supabase: Custom schemes untuk redirect ke app"
echo "   â€¢ App: Menggunakan Supabase sebagai OAuth proxy"
echo ""
echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
echo ""
